window.__require=function t(r,i,o){function a(c,s){if(!i[c]){if(!r[c]){var e=c.split("/");if(e=e[e.length-1],!r[e]){var l="function"==typeof __require&&__require;if(!s&&l)return l(e,!0);if(h)return h(e,!0);throw new Error("Cannot find module '"+c+"'")}}var n=i[c]={exports:{}};r[c][0].call(n.exports,function(t){return a(r[c][1][t]||t)},n,n.exports,t,r,i,o)}return i[c].exports}for(var h="function"==typeof __require&&__require,c=0;c<o.length;c++)a(o[c]);return a}({block:[function(t,r,i){"use strict";cc._RF.push(r,"f82ebIAdIVBNoLRwv0SXXbL","block"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onOut,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onOut,this),this.ondes=!1,this.fall=!1,this.fallok=!0,this.targetH=0},start:function(){},onTouchStart:function(t){var r=new cc.Event.EventCustom("touch_start",!0);this.node.dispatchEvent(r)},onTouchMove:function(t){var r=t.getLocation(),i=this.node.convertToNodeSpaceAR(r);if(i.y>=21){var o=new cc.Event.EventCustom("up",!0);this.node.dispatchEvent(o)}else if(i.y<=-21){o=new cc.Event.EventCustom("down",!0);this.node.dispatchEvent(o)}else if(i.x<=-21){o=new cc.Event.EventCustom("left",!0);this.node.dispatchEvent(o)}else if(i.x>=21){o=new cc.Event.EventCustom("right",!0);this.node.dispatchEvent(o)}},onOut:function(){this.node.opacity=255}}),cc._RF.pop()},{}],game:[function(t,r,i){"use strict";cc._RF.push(r,"c58a52a0UVImryQvHjTgIs7","game"),cc.Class({extends:cc.Component,properties:{block0:{default:null,type:cc.Prefab},block1:{default:null,type:cc.Prefab},block2:{default:null,type:cc.Prefab},block3:{default:null,type:cc.Prefab}},onLoad:function(){this.girdx=-200,this.girdy=100,this.girdh=10,this.girdw=10,this.blocksave=[cc.instantiate(this.block0),cc.instantiate(this.block1),cc.instantiate(this.block2),cc.instantiate(this.block3)],this.blockarr=[],this.tblock,this.mblock,this.change=!1,this.fallover=!1,this.eliminateon=!0,this.fallcount=0;for(var t=0;t<this.girdh;t++){this.blockarr[t]=new Array;for(var r=0;r<this.girdw;r++)this.blockarr[t][r]=null}this.onBuildBlock(),this.node.on("touch_start",this.onTouch_Start,this),this.node.on("up",this.onMoveUP,this),this.node.on("down",this.onMoveDown,this),this.node.on("left",this.onMoveLeft,this),this.node.on("right",this.onMoveRight,this),this.node.on("change",this.onChangeCheak,this),this.node.on("checkOver",this.onCheckOver,this)},start:function(){this.checkAll()},update:function(t){this.fallover||(this.node.off("touch_start"),this.node.off("up"),this.node.off("down"),this.node.off("left"),this.node.off("right")),this.fallover&&(this.node.on("touch_start",this.onTouch_Start,this),this.node.on("up",this.onMoveUP,this),this.node.on("down",this.onMoveDown,this),this.node.on("left",this.onMoveLeft,this),this.node.on("right",this.onMoveRight,this));for(var r=9;r>=0;r--)for(var i=0;i<=9;i++)if(null!=this.blockarr[r][i]&&this.blockarr[r][i].fall){if(this.blockarr[r][i].y==this.blockarr[r][i].targetH){this.blockarr[r][i].fall=!1,this.blockarr[r][i].fallok=!0;continue}this.blockarr[r][i].y-=5,this.blockarr[r][i].y-this.blockarr[r][i].targetH<=8&&(this.blockarr[r][i].y=this.blockarr[r][i].targetH)}for(r=9;r>=0;r--)for(i=0;i<=9;i++)null!=this.blockarr[r][i]&&this.blockarr[r][i].fallok&&(this.fallcount++,100==this.fallcount&&0==r&&9==i?(this.fallover=!0,this.fallcount=0,this.checkAll(),this.onCheckNext()):100!=this.fallcount&&0==r&&9==i&&(this.fallcount=0,this.fallover=!1))},onBuildBlock:function(){for(var t=0;t<this.girdh;t++)for(var r=0;r<this.girdw;r++){var i=cc.instantiate(this.blocksave[Math.floor(4*Math.random())]);i.y=this.girdy-40*t,i.x=this.girdx+40*r,i.fallok=!0,this.node.addChild(i),this.blockarr[t][r]=i}},onTouch_Start:function(t){this.tblock=t.target,this.tblock.opacity=100},onMoveUP:function(){for(var t=9;t>0;t--){for(var r=0;r<this.girdw;r++)if(this.tblock.x==this.blockarr[t][r].x&&this.tblock.y==this.blockarr[t][r].y){var i=this.tblock.x,o=this.tblock.y;this.blockarr[t][r].x=this.blockarr[t-1][r].x,this.blockarr[t][r].y=this.blockarr[t-1][r].y;var a=this.blockarr[t][r];this.blockarr[t-1][r].x=i,this.blockarr[t-1][r].y=o,this.blockarr[t][r]=this.blockarr[t-1][r],this.blockarr[t-1][r]=a,this.change=!0;break}if(this.change){this.change=!1;var h=new cc.Event.EventCustom("change",!1);h.detail={a:t-1,b:r,c:t,d:r},this.node.dispatchEvent(h);break}}},onMoveDown:function(){for(var t=0;t<9;t++){for(var r=0;r<this.girdw;r++)if(this.tblock.x==this.blockarr[t][r].x&&this.tblock.y==this.blockarr[t][r].y){var i=this.tblock.x,o=this.tblock.y;this.blockarr[t][r].x=this.blockarr[t+1][r].x,this.blockarr[t][r].y=this.blockarr[t+1][r].y;var a=this.blockarr[t][r];this.blockarr[t+1][r].x=i,this.blockarr[t+1][r].y=o,this.blockarr[t][r]=this.blockarr[t+1][r],this.blockarr[t+1][r]=a,this.change=!0;break}if(this.change){this.change=!1;var h=new cc.Event.EventCustom("change",!1);h.detail={a:t+1,b:r,c:t,d:r},this.node.dispatchEvent(h);break}}},onMoveLeft:function(){this.tblock.opacity=255;for(var t=0;t<this.girdh;t++){for(var r=9;r>0;r--)if(this.tblock.x==this.blockarr[t][r].x&&this.tblock.y==this.blockarr[t][r].y){var i=this.tblock.x,o=this.tblock.y;this.blockarr[t][r].x=this.blockarr[t][r-1].x,this.blockarr[t][r].y=this.blockarr[t][r-1].y;var a=this.blockarr[t][r];this.blockarr[t][r-1].x=i,this.blockarr[t][r-1].y=o,this.blockarr[t][r]=this.blockarr[t][r-1],this.blockarr[t][r-1]=a,this.change=!0;break}if(this.change){this.change=!1;var h=new cc.Event.EventCustom("change",!1);h.detail={a:t,b:r-1,c:t,d:r},this.node.dispatchEvent(h);break}}},onMoveRight:function(){this.tblock.opacity=255;for(var t=0;t<this.girdh;t++){for(var r=0;r<9;r++)if(this.tblock.x==this.blockarr[t][r].x&&this.tblock.y==this.blockarr[t][r].y){var i=this.tblock.x,o=this.tblock.y;this.blockarr[t][r].x=this.blockarr[t][r+1].x,this.blockarr[t][r].y=this.blockarr[t][r+1].y;var a=this.blockarr[t][r];this.blockarr[t][r+1].x=i,this.blockarr[t][r+1].y=o,this.blockarr[t][r]=this.blockarr[t][r+1],this.blockarr[t][r+1]=a,this.change=!0;break}if(this.change){this.change=!1;var h=new cc.Event.EventCustom("change",!1);h.detail={a:t,b:r+1,c:t,d:r},this.node.dispatchEvent(h);break}}},onChangeCheak:function(t){for(var r=!1;;){if(!r)var i=t.detail.a,o=t.detail.b;r&&(i=t.detail.c,o=t.detail.d);var a=0,h=0,c=0,s=0;if(i>0&&this.blockarr[i][o].name==this.blockarr[i-1][o].name&&(a=1,i>1&&this.blockarr[i][o].name==this.blockarr[i-2][o].name&&(a=2,i>3)))for(var e=i-3;e>=0&&this.blockarr[i][o].name==this.blockarr[e][o].name;e--)a++;if(i<9&&this.blockarr[i][o].name==this.blockarr[i+1][o].name&&(h=1,i<8&&this.blockarr[i][o].name==this.blockarr[i+2][o].name&&(h=2,i<7)))for(e=i+3;e<=9&&this.blockarr[i][o].name==this.blockarr[e][o].name;e++)h++;if(o>0&&this.blockarr[i][o].name==this.blockarr[i][o-1].name&&(c=1,o>1&&this.blockarr[i][o].name==this.blockarr[i][o-2].name&&(c=2,i>2)))for(var l=o-3;l>=0&&this.blockarr[i][o].name==this.blockarr[i][l].name;l--)c++;if(o<9&&this.blockarr[i][o].name==this.blockarr[i][o+1].name&&(s=1,o<8&&this.blockarr[i][o].name==this.blockarr[i][o+2].name&&(s=2,o<7)))for(l=o+3;l<=9&&this.blockarr[i][o].name==this.blockarr[i][l].name;l++)s++;if(r){var n=a,k=h,b=c,f=s,d=new cc.Event.EventCustom("checkOver",!1);d.detail={acu:v,acd:u,acl:m,acr:g,bcu:n,bcd:k,bcl:b,bcr:f,a:t.detail.a,b:t.detail.b,c:t.detail.c,d:t.detail.d},this.node.dispatchEvent(d);break}r=!0;var v=a,u=h,m=c,g=s}},onCheckOver:function(t){var r=t.detail.a,i=t.detail.b,o=t.detail.c,a=t.detail.d,h=!0;if(t.detail.acu+t.detail.acd>=2){h=!1;for(var c=r+t.detail.acd;c>=r-t.detail.acu;c--)this.blockarr[c][i].ondes||(this.blockarr[c][i].ondes=!0,this.blockarr[c][i].removeFromParent(!0))}if(t.detail.acl+t.detail.acr>=2){h=!1;for(var s=i-t.detail.acl;s<=i+t.detail.acr;s++)this.blockarr[r][s].ondes||(this.blockarr[r][s].removeFromParent(!0),this.blockarr[r][s].ondes=!0)}if(t.detail.bcu+t.detail.bcd>=2){h=!1;for(c=o+t.detail.bcd;c>=o-t.detail.bcu;c--)this.blockarr[c][a].ondes||(this.blockarr[c][a].removeFromParent(!0),this.blockarr[c][a].ondes=!0)}if(t.detail.bcl+t.detail.bcr>=2){h=!1;for(s=a-t.detail.bcl;s<=a+t.detail.bcr;s++)this.blockarr[o][s].ondes||(this.blockarr[o][s].removeFromParent(!0),this.blockarr[o][s].ondes=!0)}if(h){var e=this.blockarr[r][i].x,l=this.blockarr[r][i].y;this.blockarr[r][i].x=this.blockarr[o][a].x,this.blockarr[r][i].y=this.blockarr[o][a].y;var n=this.blockarr[r][i];return this.blockarr[o][a].x=e,this.blockarr[o][a].y=l,this.blockarr[r][i]=this.blockarr[o][a],void(this.blockarr[o][a]=n)}for(c=0;c<this.girdh;c++)for(s=0;s<this.girdw;s++)this.blockarr[c][s].ondes&&(this.blockarr[c][s]=null);this.onFall()},onFall:function(){for(var t=0;t<10;t++)for(var r=9;r>=0;r--)if(null==this.blockarr[r][t])for(var i=r,o=r;;)if(--o>=0){if(null!=this.blockarr[o][t]){for(var a=40*(s=i-o),h=1,c=!0;o>=0;){if(null==this.blockarr[o][t]){c=!1,r=o+s+1;break}this.blockarr[o+s][t]=this.blockarr[o][t],this.blockarr[o][t]=null,this.blockarr[o+s][t].fall=!0,this.blockarr[o+s][t].fallok=!1,this.blockarr[o+s][t].targetH=this.blockarr[o+s][t].y-a,o--}for(;s-1>=0&&c;){(e=cc.instantiate(this.blocksave[Math.floor(4*Math.random())])).y=40*h+this.girdy,e.x=this.girdx+40*t,e.fall=!0,e.fallok=!1,e.targetH=e.y-a,this.node.addChild(e),this.blockarr[s-1][t]=e,h++,s--}break}}else if(o<0){if(0==i){(e=cc.instantiate(this.blocksave[Math.floor(4*Math.random())])).y=40+this.girdy,e.x=this.girdx+40*t,e.fall=!0,e.fallok=!1,e.targetH=e.y-40,this.node.addChild(e),this.blockarr[0][t]=e;break}if(i>0){var s;for(a=40*(s=i-o),h=1;s-1>=0;){var e;(e=cc.instantiate(this.blocksave[Math.floor(4*Math.random())])).y=40*h+this.girdy,e.x=this.girdx+40*t,e.fall=!0,e.fallok=!1,e.targetH=e.y-a,this.node.addChild(e),this.blockarr[s-1][t]=e,h++,s--}break}}},checkAll:function(){for(var t=0;t<10;t++)for(var r=0;r<10;r++)this.onCheckAll(t,r)},onCheckAll:function(t,r){var i=0,o=0,a=0,h=0;if(t>0&&this.blockarr[t][r].name==this.blockarr[t-1][r].name&&(i=1,t>1&&this.blockarr[t][r].name==this.blockarr[t-2][r].name&&(i=2,t>3)))for(var c=t-3;c>=0&&this.blockarr[t][r].name==this.blockarr[c][r].name;c--)i++;if(t<9&&this.blockarr[t][r].name==this.blockarr[t+1][r].name&&(o=1,t<8&&this.blockarr[t][r].name==this.blockarr[t+2][r].name&&(o=2,t<7)))for(c=t+3;c<=9&&this.blockarr[t][r].name==this.blockarr[c][r].name;c++)o++;if(r>0&&this.blockarr[t][r].name==this.blockarr[t][r-1].name&&(a=1,r>1&&this.blockarr[t][r].name==this.blockarr[t][r-2].name&&(a=2,t>2)))for(var s=r-3;s>=0&&this.blockarr[t][r].name==this.blockarr[t][s].name;s--)a++;if(r<9&&this.blockarr[t][r].name==this.blockarr[t][r+1].name&&(h=1,r<8&&this.blockarr[t][r].name==this.blockarr[t][r+2].name&&(h=2,r<7)))for(s=r+3;s<=9&&this.blockarr[t][r].name==this.blockarr[t][s].name;s++)h++;var e=i,l=o,n=a,k=h;this.onAllCheakOver(e,l,n,k,t,r)},onCheckNext:function(){this.eliminateon=!1;for(var t=0;t<10;t++){for(var r=0;r<10;r++){if(t>1&&this.blockarr[t][r].name==this.blockarr[t-2][r].name&&t>2&&this.blockarr[t][r].name==this.blockarr[t-3][r].name)var i=!0;if(t<8&&this.blockarr[t][r].name==this.blockarr[t+2][r].name&&t<7&&this.blockarr[t][r].name==this.blockarr[t+3][r].name)var o=!0;if(r>1&&this.blockarr[t][r].name==this.blockarr[t][r-2].name&&r>2&&this.blockarr[t][r].name==this.blockarr[t][r-3].name)var a=!0;if(r<8&&this.blockarr[t][r].name==this.blockarr[t][r+2].name&&r<7&&this.blockarr[t][r].name==this.blockarr[t][r+3].name)var h=!0;(i||o||a||h)&&(this.eliminateon=!0),10!=t||10!=r||this.eliminateon||(this.onCheckAll(),this.onBuildBlock())}if(this.eliminateon)break}},onClearAll:function(){for(var t=0;t<10;t++)for(var r=0;r<10;r++)null!=this.this.blockarr[t][r]&&(this.blockarr[t][r].removeFromParent(!0),this.blockarr[t][r]=null)},onAllCheakOver:function(t,r,i,o,a,h){var c=!0;if(t+r>=2)for(var s=a+r;s>=a-t;s--)this.blockarr[s][h].ondes||(this.blockarr[s][h].ondes=!0);if(i+o>=2)for(var e=h-i;e<=h+o;e++)this.blockarr[a][e].ondes||(this.blockarr[a][e].ondes=!0);if(9==a&&9==h)for(s=0;s<10;s++)for(e=0;e<10;e++)this.blockarr[s][e].ondes&&(this.blockarr[s][e].removeFromParent(!0),this.blockarr[s][e]=null);for(s=0;s<10;s++){for(e=0;e<10;e++)if(null==this.blockarr[s][e]){c=!1;break}if(!c)break}c||this.onFall()}}),cc._RF.pop()},{}]},{},["block","game"]);